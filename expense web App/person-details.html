<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Khata History - Advanced</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="css/person-details.css">
</head>

<body>

    <div id="topBar"><i class="bi bi-arrow-left" onclick="history.back()"></i>
        <h6 class="mb-0 fw-bold">Khata History</h6>
    </div>

    <div class="person-header-card">
        <div class="h5 fw-bold text-primary mb-0" id="pName">Loading...</div>
        <div id="netBalanceDisplay" class="net-balance">Calculating...</div>

        <div class="header-stats">
            <div class="stat-box">
                <div class="stat-label">TOTAL GET</div>
                <div class="stat-val text-get" id="totalGet">₹0</div>
            </div>
            <div class="stat-box text-end">
                <div class="stat-label">TOTAL GIVE</div>
                <div class="stat-val text-give" id="totalGive">₹0</div>
            </div>
        </div>
    </div>

    <div class="history-container" id="historyList"></div>

    <div class="action-bar">
        <button class="btn-act bg-give" onclick="openModal('GIVE')">I GAVE ₹</button>
        <button class="btn-act bg-get" onclick="openModal('GET')">I GOT ₹</button>
    </div>

    <div class="modal fade" id="txModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title fw-bold" id="modalTitle">Entry</h5><button type="button"
                        class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editId">
                    <input type="hidden" id="txType">
                    <div class="mb-3"><label class="small text-muted mb-1">Date</label><input type="date" id="txDate"
                            class="form-control"></div>
                    <div class="mb-3"><label class="small text-muted mb-1">Amount</label><input type="number"
                            id="txAmount" class="form-control form-control-lg fw-bold" placeholder="₹ 0.00"></div>
                    <div class="mb-3"><label class="small text-muted mb-1">Description</label><input type="text"
                            id="txDesc" class="form-control" placeholder="What is this for?"></div>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-outline-danger fw-bold py-2" id="deleteBtn"
                        onclick="deleteFromModal()" style="display:none;">DELETE</button>
                    <button type="button" class="btn btn-primary flex-fill fw-bold py-2"
                        onclick="saveTransaction()">SAVE ENTRY</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script src="js/firebase-init.js"></script>
    <script src="js/person-details.js"></script>
    <script src="bottom-nav.js"></script>
    <script src="js/pwa.js"></script>
</body>

</html>